{"ast":null,"code":"import _slicedToArray from\"D:/Files/Projects/- WEB/TravelersDream/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"D:/Files/Projects/- WEB/TravelersDream/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/Files/Projects/- WEB/TravelersDream/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/Files/Projects/- WEB/TravelersDream/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/Files/Projects/- WEB/TravelersDream/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Cookies from'js-cookie';import{request,requests,uploadFiles,getToken}from'./requests';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LK=/*#__PURE__*/function(_Component){_inherits(LK,_Component);var _super=_createSuper(LK);function LK(props){var _this;_classCallCheck(this,LK);_this=_super.call(this,props);_this.handleOutsideClick=function(event){if(_this.box&&_this.box.current!==null&&!_this.box.current.contains(event.target)){if(window.getComputedStyle(document.getElementById(\"UserHeaderMore\")).getPropertyValue(\"visibility\")==='visible')document.getElementById(\"UserHeaderMore\").style.visibility='hidden';}};_this.state={me:{username:'',photo:'http://dream/profilepictures/0.png'},blocks:{categories:[],types:[],list:[],createNewPanel:/*#__PURE__*/_jsx(\"div\",{id:\"LKMIB-CNew\",className:\"create-new\",children:\" \"})},currCP:{action:3,type:'',photo:undefined,data:{}},currList:''};_this.update();return _this;}_createClass(LK,[{key:\"mib\",value:function mib(){document.getElementById(\"LKMIB\").style.visibility=\"hidden\";document.getElementById(\"LKMIB-CNew\").style.animation=\"hideToDown 0.3s\";document.getElementById(\"LKMIB-CNew\").style.visibility=\"hidden\";document.getElementById(\"LKMIB-CNew\").style.opacity=\"0\";this.setBlocks({createNewPanel:/*#__PURE__*/_jsx(\"div\",{id:\"LKMIB-CNew\",className:\"create-new\",children:\" \"})});}},{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener('click',this.handleOutsideClick);}},{key:\"showMore\",value:function showMore(){if(window.getComputedStyle(document.getElementById(\"UserHeaderMore\")).getPropertyValue(\"visibility\")==='hidden')document.getElementById(\"UserHeaderMore\").style.visibility='visible';else document.getElementById(\"UserHeaderMore\").style.visibility='hidden';}},{key:\"setListOf\",value:function setListOf(l){var _this2=this;request('getListOf',{token:getToken(),list:l}).then(function(res){if(!res.data.success)return;var __blocks=[];var __think=function __think(t,u){switch(t){case'clients':return/*#__PURE__*/_jsx(\"div\",{className:\"not-enought\",onClick:function onClick(){_this2.showCreatePanel(1,l,{id:u.id,name:u.name});}});case'contracts':return/*#__PURE__*/_jsx(\"div\",{className:\"not-enought\",onClick:function onClick(){_this2.showCreatePanel(1,l,{id:u.id,name:u.name});}});case'payments':return/*#__PURE__*/_jsx(\"div\",{className:\"not-enought\",onClick:function onClick(){_this2.showCreatePanel(1,l,{id:u.id,name:u.name});}});case'users':return/*#__PURE__*/_jsxs(\"div\",{className:\"not-enought\",onClick:function onClick(){_this2.showCreatePanel(1,l,{id:u.id,name:u.name,fio:u.fio,bdate:u.bdate,typeid:u.typeid-1,photo:u.photo});},children:[/*#__PURE__*/_jsx(\"img\",{className:\"u-picture\",src:u.photo,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"u-info-nt\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"u-name u-text\",children:u.name}),/*#__PURE__*/_jsx(\"p\",{className:\"u-type u-text\",children:u.type})]})]});case'usertypes':return/*#__PURE__*/_jsx(\"div\",{className:\"not-enought\",onClick:function onClick(){_this2.showCreatePanel(1,l,{id:u.id,type:u.type,permissions:u.permissions});},children:/*#__PURE__*/_jsx(\"div\",{className:\"u-info-nt\",children:/*#__PURE__*/_jsx(\"p\",{className:\"u-name u-text\",children:u.type})})});default:return/*#__PURE__*/_jsx(\"div\",{className:\"not-enought\"});}};res.data.data.list.map(function(u){__blocks.push(__think(l,u));});_this2.setBlocks({list:__blocks});var __currList=document.getElementById(\"cat\".concat(_this2.state.currList));if(__currList)__currList.style.backgroundColor='';document.getElementById(\"cat\".concat(l)).style.backgroundColor='#2c2c34';_this2.setState({currList:l});});}},{key:\"setBlocks\",value:function setBlocks(block,cb){if(!cb)this.setState(function(prevState){return{blocks:Object.assign(prevState.blocks,block)};});else this.setState(function(prevState){return{blocks:Object.assign(prevState.blocks,block)};},cb);}},{key:\"update\",value:function update(category){var _this3=this;requests({'getUserInfo':{keys:['name','photo']},'getTypes':{},'getCategories':{}},{'token':getToken()}).then(function(res){if(res.success){var data=res.result;if(data.getUserInfo.success)// getUserInfo\n_this3.setState({me:{username:data.getUserInfo.data.name,photo:data.getUserInfo.data.photo}});else _this3.logOut();if(data.getTypes.success){// getTypes\nvar __types=[];var __counter=0;data.getTypes.data.types.map(function(type){__types.push(/*#__PURE__*/_jsxs(\"option\",{value:__counter,children:[\" \",type,\" \"]}));__counter++;});_this3.setBlocks({types:__types});}if(data.getCategories.success){// getCategories\nvar __categories=[];var _counter=1;var __getName=function __getName(cat){switch(cat){case'clients':return'Клиенты';case'contracts':return'Договоры';case'payments':return'Платежи';case'users':return'Пользователи';case'usertypes':return'Типы пользователей';default:return'';}};data.getCategories.data.categories.map(function(c){if(!category&&_counter===1)_this3.setListOf(c);__categories.push(/*#__PURE__*/_jsxs(\"p\",{id:\"cat\".concat(c),className:\"cat-\".concat(_counter),onClick:function onClick(){return _this3.setListOf(c);},children:[\" \",__getName(c),\" \"]}));_counter++;});if(category)_this3.setListOf(category);_this3.setBlocks({categories:__categories});}}});}},{key:\"showCreatePanel\",value:function showCreatePanel(action,type,params){var _this4=this;this.setState({currCP:{action:action,type:type,data:params}});var __getInput=function __getInput(t){switch(t){case'users':return[/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-name input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0418\\u043C\\u044F \"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:\"inputName\",className:\"r\",type:\"text\",defaultValue:params.name?params.name:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-fio input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0424\\u0418\\u041E \"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:\"inputFIO\",type:\"text\",onChange:function onChange(e){var fio=e.target.value.split(\" \");document.getElementById(\"inputName\").value=(fio[0]?fio[0]:\"\")+(fio[1]?\" \".concat(fio[1][0],\".\"):\"\")+(fio[2]?\" \".concat(fio[2][0],\".\"):\"\");},defaultValue:params.fio?params.fio:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-date input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0414\\u0430\\u0442\\u0430 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:\"inputBDate\",type:\"date\",defaultValue:params.bdate?params.bdate:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-type input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0422\\u0438\\u043F \"}),\" \",/*#__PURE__*/_jsxs(\"select\",{id:\"selectType\",defaultValue:params.type?params.type:0,children:[\" \",_this4.state.blocks.types,\" \"]})]})]}),action===0?'Создание':params.name];case'clients':return[/*#__PURE__*/_jsx(_Fragment,{}),action===0?'Создание':''];case'contracts':return[/*#__PURE__*/_jsx(_Fragment,{}),action===0?'Создание':''];case'payments':return[/*#__PURE__*/_jsx(_Fragment,{}),action===0?'Создание':''];case'usertypes':return[/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-name input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0422\\u0438\\u043F \"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:\"inputName\",type:\"text\",defaultValue:params.type?params.type:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-type input-row\",children:[/*#__PURE__*/_jsx(\"p\",{children:\" \\u0420\\u0430\\u0437\\u0440\\u0435\\u0448\\u0435\\u043D\\u0438\\u044F \"}),\" \",/*#__PURE__*/_jsx(\"select\",{id:\"selectType\",defaultValue:0,children:\" \"})]})]}),action===0?'Создание':params.type];default:return/*#__PURE__*/_jsx(_Fragment,{});}};var _getInput=__getInput(type),_getInput2=_slicedToArray(_getInput,2),__textInput=_getInput2[0],__title=_getInput2[1];var __imageInput=type==='users'?/*#__PURE__*/_jsxs(\"div\",{className:\"image-input-block\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"image-title\",children:\" \\u0424\\u043E\\u0442\\u043E \"}),/*#__PURE__*/_jsx(\"input\",{id:\"imageInput\",className:\"image-input\",type:\"image\",onClick:function onClick(){return document.getElementById(\"fileInput\").click();},src:params.photo?params.photo:'http://dream/profilepictures/0.png'}),/*#__PURE__*/_jsx(\"input\",{id:\"fileInput\",type:\"file\",accept:\"image/*\",onChange:function onChange(e){_this4.setState(function(prevState){return{currCP:Object.assign(prevState.currCP,{photo:e.target.files[0]})};});document.getElementById(\"imageInput\").src=window.URL.createObjectURL(e.target.files[0]);}})]}):/*#__PURE__*/_jsx(_Fragment,{});var __newCP=/*#__PURE__*/_jsxs(\"div\",{id:\"LKMIB-CNew\",className:\"create-new\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title-block\",children:[/*#__PURE__*/_jsxs(\"p\",{id:\"CNewTitle\",className:\"title-name\",children:[\" \",__title,\" \"]}),/*#__PURE__*/_jsx(\"svg\",{className:\"title-close\",viewBox:\"0 0 20 20\",onClick:function onClick(){return _this4.mib();},children:/*#__PURE__*/_jsx(\"path\",{fill:\"white\",d:\"M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-block\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-input\",children:[__textInput,/*#__PURE__*/_jsx(\"button\",{className:\"button-save\",onClick:function onClick(){var __getCurrData=function __getCurrData(t){switch(t){case'users':return{name:document.getElementById(\"inputName\").value,fio:document.getElementById(\"inputFIO\").value,bdate:document.getElementById(\"inputBDate\").value,type:+document.getElementById(\"selectType\").value+1,photo:_this4.state.currCP.photo};case'clients':return{};case'contracts':return{};case'payments':return{};case'usertypes':return{};default:return{};}};var __query={};var __currData=__getCurrData(_this4.state.currCP.type);if(_this4.state.currCP.action===1){// update\nvar __originalData=_this4.state.currCP.data;Object.keys(__originalData).map(function(key){if(__currData[key]!==__originalData[key]&&key!=='photo'&&key!=='id')__query[key]=__currData[key];});uploadFiles('updateUserInfo',{token:getToken(),id:__originalData.id,keys:__query},[__currData.photo?__currData.photo:undefined]).then(function(res){_this4.update(_this4.state.currCP.type);_this4.showCreatePanel(1,_this4.state.currCP.type,Object.assign({id:__originalData.id,photo:__currData.photo?window.URL.createObjectURL(__currData.photo):__originalData.photo,typeid:__currData.type},__query));});}else if(_this4.state.currCP.action===0){// create\nObject.keys(__currData).map(function(key){if(key!=='photo')__query[key]=__currData[key];});uploadFiles(\"createUser\",{token:getToken(),keys:__query},[__currData.photo?__currData.photo:undefined]).then(function(res){_this4.update(_this4.state.currCP.type);_this4.mib();});}},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]}),__imageInput]})]});this.setBlocks({createNewPanel:__newCP},function(){document.getElementById(\"LKMIB\").style.visibility=\"visible\";document.getElementById(\"LKMIB\").style.opacity=\"1\";document.getElementById(\"LKMIB-CNew\").style.animation=\"showFromUp 0.3s\";document.getElementById(\"LKMIB-CNew\").style.visibility=\"visible\";document.getElementById(\"LKMIB-CNew\").style.opacity=\"1\";});}},{key:\"logOut\",value:function logOut(){Cookies.remove('data',{path:'',domain:'localhost'});this.props.props.history.push({pathname:'/auth'});}},{key:\"render\",value:function render(){var _this5=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsxs(\"ul\",{className:\"main-ul\",children:[/*#__PURE__*/_jsxs(\"li\",{id:\"Logo\",children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:\"Sources/images/logo.png\",alt:\"\"}),\" \"]}),/*#__PURE__*/_jsxs(\"li\",{id:\"UserHeader\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"UserHeaderMain\",className:\"user-header-main\",ref:this.box,onClick:function onClick(){return _this5.showMore();},children:[/*#__PURE__*/_jsxs(\"p\",{className:\"user-name\",children:[\" \",this.state.me.username,\" \"]}),/*#__PURE__*/_jsx(\"img\",{className:\"user-picture\",src:this.state.me.photo,alt:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"UserHeaderMore\",className:\"user-header-more\",children:[/*#__PURE__*/_jsx(\"a\",{className:\"button-profile\",children:\" \\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \"}),/*#__PURE__*/_jsx(\"a\",{className:\"button-logout\",onClick:function onClick(){return _this5.logOut();},children:\" \\u0412\\u044B\\u0439\\u0442\\u0438 \"})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"LK\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"categoriesList\",className:\"gr-list\",children:[\" \",this.state.blocks.categories,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"list-of\",children:[/*#__PURE__*/_jsx(\"p\",{id:\"createButton\",className:\"button-create\",onClick:function onClick(){_this5.showCreatePanel(0,_this5.state.currList,{});},children:\" \\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \"}),this.state.blocks.list]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"LKMIB\",className:\"mib\",onClick:function onClick(){return _this5.mib();}}),this.state.blocks.createNewPanel]})]});}}]);return LK;}(Component);;export default LK;","map":{"version":3,"sources":["D:/Files/Projects/- WEB/TravelersDream/front/src/Components/Lk.js"],"names":["React","Component","Cookies","request","requests","uploadFiles","getToken","LK","props","handleOutsideClick","event","box","current","contains","target","window","getComputedStyle","document","getElementById","getPropertyValue","style","visibility","state","me","username","photo","blocks","categories","types","list","createNewPanel","currCP","action","type","undefined","data","currList","update","animation","opacity","setBlocks","addEventListener","l","token","then","res","success","__blocks","__think","t","u","showCreatePanel","id","name","fio","bdate","typeid","permissions","map","push","__currList","backgroundColor","setState","block","cb","prevState","Object","assign","category","keys","result","getUserInfo","logOut","getTypes","__types","__counter","getCategories","__categories","__getName","cat","c","setListOf","params","__getInput","e","value","split","__textInput","__title","__imageInput","click","files","src","URL","createObjectURL","__newCP","mib","__getCurrData","__query","__currData","__originalData","key","remove","path","domain","history","pathname","showMore"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Cookies from 'js-cookie';\r\nimport {request, requests, uploadFiles, getToken} from './requests';\r\n\r\nclass LK extends Component {\r\n    constructor (props) {\r\n        super (props);\r\n        this.state = {\r\n            me: { username: '', photo: 'http://dream/profilepictures/0.png' },\r\n            blocks: {\r\n                categories: [],\r\n                types: [],\r\n                list: [],\r\n                createNewPanel: <div id='LKMIB-CNew' className='create-new'> </div>\r\n            },\r\n            currCP: {\r\n                action: 3,\r\n                type: '',\r\n                photo: undefined,\r\n                data: {}\r\n            },\r\n            currList: ''\r\n        };\r\n        this.update();\r\n    };\r\n\r\n    mib() {\r\n        document.getElementById(\"LKMIB\").style.visibility = \"hidden\";\r\n        document.getElementById(\"LKMIB-CNew\").style.animation = \"hideToDown 0.3s\";\r\n        document.getElementById(\"LKMIB-CNew\").style.visibility = \"hidden\";\r\n        document.getElementById(\"LKMIB-CNew\").style.opacity = \"0\";\r\n\r\n        this.setBlocks({createNewPanel: <div id='LKMIB-CNew' className='create-new'> </div>});\r\n    };\r\n    componentDidMount() { document.addEventListener('click', this.handleOutsideClick); }\r\n    handleOutsideClick = (event) => {\r\n        if (this.box && this.box.current !== null && !this.box.current.contains(event.target)) {\r\n            if (window.getComputedStyle(document.getElementById(\"UserHeaderMore\")).getPropertyValue(\"visibility\") === 'visible')\r\n                document.getElementById(\"UserHeaderMore\").style.visibility = 'hidden';\r\n        }\r\n    }\r\n    showMore() {\r\n        if (window.getComputedStyle(document.getElementById(\"UserHeaderMore\")).getPropertyValue(\"visibility\") === 'hidden')\r\n            document.getElementById(\"UserHeaderMore\").style.visibility = 'visible';\r\n        else\r\n            document.getElementById(\"UserHeaderMore\").style.visibility = 'hidden';\r\n    };\r\n\r\n    setListOf(l) {\r\n        request('getListOf', { token:getToken(), list: l}).then(res => {\r\n            if (!res.data.success) return;\r\n            let __blocks = [];\r\n            let __think = (t, u) => {\r\n                switch (t) {\r\n                    case 'clients':\r\n                        return (\r\n                            <div className='not-enought' onClick={() => {\r\n                                this.showCreatePanel(1, l, { id: u.id, name: u.name });\r\n                            }}>\r\n                            </div>\r\n                        );\r\n                    case 'contracts':\r\n                        return (\r\n                            <div className='not-enought' onClick={() => {\r\n                                this.showCreatePanel(1, l, { id: u.id, name: u.name });\r\n                            }}>\r\n                            </div>\r\n                        );\r\n                    case 'payments':\r\n                        return (\r\n                            <div className='not-enought' onClick={() => {\r\n                                this.showCreatePanel(1, l, { id: u.id, name: u.name });\r\n                            }}>\r\n                            </div>\r\n                        );\r\n                    case 'users':\r\n                        return (\r\n                        <div className='not-enought' onClick={() => {\r\n                            this.showCreatePanel(1, l, { id: u.id, name: u.name, fio: u.fio, bdate: u.bdate, typeid: u.typeid - 1, photo: u.photo });\r\n                        }}>\r\n                            <img className='u-picture' src={u.photo} alt='' />\r\n                            <div className='u-info-nt'>\r\n                                <p className='u-name u-text'>{u.name}</p>\r\n                                <p className='u-type u-text'>{u.type}</p>\r\n                            </div>\r\n                        </div>);\r\n                    case 'usertypes':\r\n                        return (\r\n                            <div className='not-enought' onClick={() => {\r\n                                this.showCreatePanel(1, l, { id: u.id, type: u.type, permissions: u.permissions });\r\n                            }}>\r\n                                <div className='u-info-nt'>\r\n                                    <p className='u-name u-text'>{u.type}</p>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    default:\r\n                        return <div className='not-enought' />;\r\n                }\r\n            }\r\n\r\n            res.data.data.list.map(u => {\r\n                __blocks.push( __think(l, u) );\r\n            });\r\n\r\n            this.setBlocks({list: __blocks});\r\n\r\n            let __currList = document.getElementById(`cat${this.state.currList}`);\r\n            if (__currList) __currList.style.backgroundColor = '';\r\n            document.getElementById(`cat${l}`).style.backgroundColor = '#2c2c34';\r\n            this.setState({currList: l});\r\n        });\r\n    }\r\n\r\n    setBlocks(block, cb) {\r\n        if (!cb) this.setState((prevState) => {\r\n            return { blocks: Object.assign(prevState.blocks, block) };\r\n        });\r\n        else  this.setState((prevState) => {\r\n            return { blocks: Object.assign(prevState.blocks, block) };\r\n        }, cb);\r\n    }\r\n\r\n    update(category) {\r\n        requests({\r\n            'getUserInfo': {keys: ['name', 'photo']},\r\n            'getTypes': {},\r\n            'getCategories': {}\r\n        }, { 'token': getToken() }).then(res => {\r\n            if (res.success) {\r\n                let data = res.result;\r\n                if (data.getUserInfo.success) // getUserInfo\r\n                    this.setState({\r\n                        me: {\r\n                            username: data.getUserInfo.data.name,\r\n                            photo: data.getUserInfo.data.photo\r\n                        }\r\n                    });\r\n                else this.logOut();\r\n                \r\n                if (data.getTypes.success) { // getTypes\r\n                    let __types = [];\r\n                    let __counter = 0;\r\n                    data.getTypes.data.types.map(type => {\r\n                        __types.push( <option value={__counter}> {type} </option> );\r\n                        __counter ++;\r\n                    });\r\n                    this.setBlocks({types:  __types})\r\n                }\r\n\r\n                if (data.getCategories.success) { // getCategories\r\n                    let __categories = [];\r\n                    let __counter = 1;\r\n                    let __getName = (cat) => {\r\n                        switch (cat) {\r\n                            case 'clients':\r\n                                return 'Клиенты';\r\n                            case 'contracts':\r\n                                return 'Договоры';\r\n                            case 'payments':\r\n                                return 'Платежи';\r\n                            case 'users':\r\n                                return 'Пользователи';\r\n                            case 'usertypes':\r\n                                return 'Типы пользователей';\r\n                            default:\r\n                                return '';\r\n                        }\r\n                    };\r\n\r\n                    data.getCategories.data.categories.map(c => {\r\n                        if (!category && __counter === 1) this.setListOf(c);\r\n                        __categories.push(\r\n                            <p id={`cat${c}`} className={`cat-${__counter}`}\r\n                                onClick={() => this.setListOf(c) }> {__getName(c)} </p>\r\n                        )\r\n                        __counter ++;\r\n                    });\r\n\r\n                    if (category) this.setListOf(category);\r\n                    this.setBlocks({categories: __categories});\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    showCreatePanel(action, type, params) {\r\n        this.setState({currCP: {action: action, type: type, data: params}});\r\n        const __getInput = (t) => {\r\n            switch (t) {\r\n                case 'users':\r\n                    return [<>\r\n                        <div className='input-name input-row'> \r\n                            <p> Имя </p> <input id='inputName' className='r' type='text' defaultValue={params.name ? params.name : ''} />\r\n                        </div>\r\n                        <div className=\"input-fio input-row\">\r\n                            <p> ФИО </p> <input id=\"inputFIO\" type=\"text\" onChange={(e) => {\r\n                                let fio = e.target.value.split(\" \");\r\n                                document.getElementById(\"inputName\").value = (fio[0] ? fio[0] : \"\") + \r\n                                    (fio[1] ?  ` ${fio[1][0]}.` : \"\") + \r\n                                    (fio[2] ? ` ${fio[2][0]}.` : \"\");\r\n                            }} defaultValue={params.fio ? params.fio : ''} />\r\n                        </div>\r\n                        <div className=\"input-date input-row\">\r\n                            <p> Дата рождения </p> <input id=\"inputBDate\" type=\"date\" defaultValue={params.bdate ? params.bdate : ''} />\r\n                        </div>\r\n                        <div className=\"input-type input-row\">\r\n                            <p> Тип </p> <select id=\"selectType\" defaultValue={params.type ? params.type : 0}> {this.state.blocks.types} </select>\r\n                        </div>\r\n                    </>, action === 0 ? 'Создание' : params.name];\r\n                case 'clients':\r\n                    return [<></>, action === 0 ? 'Создание' : ''];\r\n                case 'contracts':\r\n                    return [<></>, action === 0 ? 'Создание' : ''];\r\n                case 'payments':\r\n                    return [<></>, action === 0 ? 'Создание' : ''];\r\n                case 'usertypes':\r\n                    return [<>\r\n                        <div className='input-name input-row'> \r\n                            <p> Тип </p> <input id='inputName' type='text' defaultValue={params.type ? params.type : ''} />\r\n                        </div>\r\n                        <div className=\"input-type input-row\">\r\n                            <p> Разрешения </p> <select id=\"selectType\" defaultValue={0}> </select>\r\n                        </div>\r\n                    </>, action === 0 ? 'Создание' : params.type];\r\n                default:\r\n                    return <></>\r\n            }\r\n        };\r\n        const [__textInput, __title] = __getInput(type);\r\n        const __imageInput = (type === 'users') ? \r\n        <div className=\"image-input-block\">\r\n            <p className=\"image-title\"> Фото </p>\r\n            <input id=\"imageInput\" className=\"image-input\" type=\"image\" onClick={ () => document.getElementById(\"fileInput\").click() } src={ params.photo ? params.photo : 'http://dream/profilepictures/0.png' }/>\r\n            <input id=\"fileInput\" type=\"file\" accept=\"image/*\" onChange={(e) => {\r\n                this.setState((prevState) => {\r\n                    return { currCP: Object.assign(prevState.currCP, {photo: e.target.files[0]}) };\r\n                });\r\n                document.getElementById(\"imageInput\").src = window.URL.createObjectURL(e.target.files[0]);\r\n            }} />\r\n        </div> : <></>;\r\n\r\n        let __newCP = (\r\n            <div id='LKMIB-CNew' className='create-new'>\r\n                <div className=\"title-block\">\r\n                    <p id=\"CNewTitle\" className=\"title-name\"> {__title} </p>\r\n                    <svg className=\"title-close\" viewBox=\"0 0 20 20\" onClick={ () => this.mib() }>\r\n\t\t\t\t\t\t<path fill=\"white\" d=\"M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z\"></path>\r\n\t\t\t\t\t</svg>\r\n                </div>\r\n                <div className='input-block'>\r\n                    <div className='text-input'>\r\n                        {__textInput}\r\n                        <button className='button-save' onClick={()=>{\r\n                            let __getCurrData = (t) => {\r\n                                switch (t) {\r\n                                    case 'users':\r\n                                        return {\r\n                                            name: document.getElementById(\"inputName\").value,\r\n                                            fio: document.getElementById(\"inputFIO\").value,\r\n                                            bdate: document.getElementById(\"inputBDate\").value,\r\n                                            type: +document.getElementById(\"selectType\").value + 1,\r\n                                            photo: this.state.currCP.photo\r\n                                        };\r\n                                    case 'clients': \r\n                                        return {};\r\n                                    case 'contracts':\r\n                                        return {};\r\n                                    case 'payments':\r\n                                        return {};\r\n                                    case 'usertypes':\r\n                                        return {};\r\n                                    default:\r\n                                        return {};\r\n                                }\r\n                            };\r\n                            let __query = {};\r\n                            let __currData = __getCurrData(this.state.currCP.type);\r\n                            if (this.state.currCP.action === 1) { // update\r\n                                let __originalData = this.state.currCP.data;\r\n\r\n                                Object.keys(__originalData).map(key => {\r\n                                    if (__currData[key] !== __originalData[key] && key !== 'photo' && key !== 'id') __query[key] = __currData[key];\r\n                                });\r\n                                uploadFiles('updateUserInfo', { token: getToken(), id: __originalData.id, keys: __query }, [__currData.photo ? __currData.photo : undefined]).then(res => {\r\n                                    this.update(this.state.currCP.type);\r\n                                    this.showCreatePanel(1, this.state.currCP.type, Object.assign({\r\n                                        id: __originalData.id, photo: __currData.photo ? window.URL.createObjectURL(__currData.photo) : __originalData.photo, typeid: __currData.type\r\n                                    }, __query));\r\n                                });\r\n                            } else if (this.state.currCP.action === 0) { // create\r\n                                Object.keys(__currData).map(key => {\r\n                                    if (key !== 'photo') __query[key] = __currData[key];\r\n                                });\r\n                                uploadFiles(\"createUser\", {token: getToken(), keys: __query}, [__currData.photo ? __currData.photo : undefined]).then( res => {\r\n                                    this.update(this.state.currCP.type);\r\n                                    this.mib();\r\n                                });\r\n                            }\r\n\r\n                        }}>Сохранить</button>\r\n                    </div>\r\n                    {__imageInput}\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n        this.setBlocks({createNewPanel: __newCP}, () => {\r\n            document.getElementById(\"LKMIB\").style.visibility = \"visible\";\r\n            document.getElementById(\"LKMIB\").style.opacity = \"1\";\r\n            document.getElementById(\"LKMIB-CNew\").style.animation = \"showFromUp 0.3s\";\r\n            document.getElementById(\"LKMIB-CNew\").style.visibility = \"visible\";\r\n            document.getElementById(\"LKMIB-CNew\").style.opacity = \"1\";\r\n        });\r\n    };\r\n\r\n    logOut() {\r\n        Cookies.remove('data', {\r\n            path: '',\r\n            domain: 'localhost'\r\n        });\r\n        this.props.props.history.push({ pathname: '/auth' });\r\n    };\r\n    \r\n    render() {\r\n        return (\r\n        <>\r\n            <header>\r\n                <ul className='main-ul'>\r\n                    <li id='Logo'> <img src=\"Sources/images/logo.png\" alt='' /> </li>\r\n                    <li id='UserHeader'>\r\n                        <div id='UserHeaderMain' className='user-header-main' ref={this.box} onClick={() => this.showMore()}>\r\n                            <p className='user-name'> {this.state.me.username} </p>\r\n                            <img className='user-picture' src={this.state.me.photo} alt='' />\r\n                        </div>\r\n                        <div id='UserHeaderMore' className='user-header-more'>\r\n                            <a className='button-profile'> Профиль </a>\r\n                            <a className='button-logout' onClick={() => this.logOut()} > Выйти </a>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </header>\r\n            <div id='LK'>\r\n                <div className='control-panel'>\r\n                    <div id='categoriesList' className='gr-list'> {this.state.blocks.categories} </div>\r\n                    <div className='list-of'>\r\n                        <p id='createButton' className='button-create' onClick={() => {\r\n                            this.showCreatePanel(0, this.state.currList, {});\r\n                        }}> Создать </p>\r\n                        {this.state.blocks.list}\r\n                    </div>\r\n                </div>\r\n                <div id='LKMIB' className='mib' onClick={ () => this.mib() } />\r\n                {this.state.blocks.createNewPanel}\r\n            </div>    \r\n        </>\r\n        );\r\n    }\r\n};\r\n\r\nexport default LK;"]},"metadata":{},"sourceType":"module"}