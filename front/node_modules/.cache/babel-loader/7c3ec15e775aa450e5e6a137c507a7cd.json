{"ast":null,"code":"import JSZip from 'jszip';\n/**\r\n * Reads XLSX file in a browser.\r\n * @param  {file} file - A file being uploaded in the browser.\r\n * @return {Promise} Resolves to an object holding XLSX file entries.\r\n */\n\nexport default function unpackXlsxFile(file) {\n  var files = {};\n  return JSZip.loadAsync(file).then(function (zip) {\n    var files = [];\n    zip.forEach(function (relativePath, zipEntry) {\n      if (!zipEntry.dir) {\n        files.push(zipEntry.name);\n      }\n    });\n    var entries = {};\n    return Promise.all(files.map(function (file) {\n      return zip.file(file).async('string').then(function (content) {\n        return entries[file] = content;\n      });\n    })).then(function () {\n      return entries;\n    });\n  });\n}","map":{"version":3,"sources":["../../source/read/unpackXlsxFileBrowser.js"],"names":["files","zip","zipEntry","entries"],"mappings":"AAAA,OAAA,KAAA,MAAA,OAAA;AAEA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAAA,cAAA,CAAA,IAAA,EAA8B;AAC5C,MAAMA,KAAK,GAAX,EAAA;AAEA,SAAO,KAAK,CAAL,SAAA,CAAA,IAAA,EAAA,IAAA,CAA2B,UAAA,GAAA,EAAS;AAC1C,QAAMA,KAAK,GAAX,EAAA;AACAC,IAAAA,GAAG,CAAHA,OAAAA,CAAY,UAAA,YAAA,EAAA,QAAA,EAA4B;AACvC,UAAI,CAACC,QAAQ,CAAb,GAAA,EAAmB;AAClBF,QAAAA,KAAK,CAALA,IAAAA,CAAWE,QAAQ,CAAnBF,IAAAA;AACA;AAHFC,KAAAA;AAMA,QAAME,OAAO,GAAb,EAAA;AACA,WAAO,OAAO,CAAP,GAAA,CAAY,KAAK,CAAL,GAAA,CAAU,UAAA,IAAA,EAAU;AACtC,aAAO,GAAG,CAAH,IAAA,CAAA,IAAA,EAAA,KAAA,CAAA,QAAA,EAAA,IAAA,CAAoC,UAAA,OAAA,EAAO;AAAA,eAAIA,OAAO,CAAPA,IAAO,CAAPA,GAAJ,OAAA;AAAlD,OAAO,CAAP;AADM,KAAY,CAAZ,EAAA,IAAA,CAGD,YAAA;AAAA,aAAA,OAAA;AAHN,KAAO,CAAP;AATD,GAAO,CAAP;AAcA","sourcesContent":["import JSZip from 'jszip'\r\n\r\n/**\r\n * Reads XLSX file in a browser.\r\n * @param  {file} file - A file being uploaded in the browser.\r\n * @return {Promise} Resolves to an object holding XLSX file entries.\r\n */\r\nexport default function unpackXlsxFile(file) {\r\n\tconst files = {}\r\n\r\n\treturn JSZip.loadAsync(file).then((zip) => {\r\n\t\tconst files = []\r\n\t\tzip.forEach((relativePath, zipEntry) => {\r\n\t\t\tif (!zipEntry.dir) {\r\n\t\t\t\tfiles.push(zipEntry.name)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst entries = {}\r\n\t\treturn Promise.all(files.map((file) => {\r\n\t\t\treturn zip.file(file).async('string').then(content => entries[file] = content)\r\n\t\t}))\r\n\t\t.then(() => entries)\r\n\t})\r\n}"]},"metadata":{},"sourceType":"module"}